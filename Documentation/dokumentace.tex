\documentclass [11pt, a4paper]{article}

\usepackage[left=1.5cm, text={18cm, 25cm}, top = 2.5cm]{geometry}
\usepackage{times}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage[czech]{babel}
\usepackage[utf8]{inputenc}
\usepackage[IL2]{fontenc}
\usepackage{verbatim}
\usepackage{graphics}

\begin{document}
\begin{center}

%%% Title page %%%
\Huge
\textsc{Fakulta informačních technologií\\
Vysoké učení technické v Brně}
\\[84mm]
\Huge \textbf{Dokumentácia -- IFJ 2018}\\
\LARGE Tím 40, varianta II
\vspace{\stretch{9.5}}
\end{center}


\hfill

%%% Names %%%
\begin{minipage}[l]{0.6 \textwidth}
\Large
\begin{tabular}{l l l}
Adam Hostin  & xhosti02  & \quad25\,\%\\
Sabína Gregušová & xgregu02 & \quad25\,\% \\
\textbf{Dominik Peza}  & \textbf{xpezad00}  & \quad\textbf{25\,\%}\\
Adrián Tulušák  & xtulus00  & \quad25\,\%\\
\end{tabular}
\end{minipage}




\thispagestyle{empty}
\clearpage

%%% Content table %%%
\setcounter{page}{1}
\tableofcontents
\clearpage


\section{Úvod}
Naším cieľom je implementovať prekladač imperatívneho jazyka IFJ18 do predmetov IFJ a IAL v jazyku C. Hlavnou náplňou práce bola implementácia: lexikálneho analyzátora, parsera (syntaktická a sématická analýza) a generátora inštrukcií.

\section{Lexikálna analýza}
Na začiatku sme implementovali lexikálny analyzátor v súbore \texttt{lexer.c}, ktorého základom je deterministický konečný automat (ďalej iba DKA).  Hlavnou funkciou v tomto súbore je \texttt{get\_next\_token}, ktorá číta jednotlivé znaky a pomocou príkazu \texttt{switch} prechádza do nasledujúcich stavov podľa DKA až kým nevyhodnotí  lexikálne správny token, inak vracia \texttt{ER\_LEX}. Lexikálny analyzátor musí mať nadstavený vstupný súbor, ktorý obsahuje program napísaný v jazyku IFJ18. Pri úspešnom vyhodnotení tokenu sa správne uvoľní všetká alokovaná pamäť. Matematické a relačné operátory sú vyhodnotené vcelku rýchlo a jednoducho, identifikátory, reťazce a čísla vyžadujú viacej prechodov a používajú dynamický reťazec, o ktorom ďalej pojednáva sekcia Spracovanie reťazcov. Pri identifikátore sa kontrolujú povolené znaky na základe pozície v reťazci a na záver sa identifikátor porovná so všetkými kľúčovými slovami, ak sa nájde zhoda, je to kľúčové slovo, inak je to identifikátor. Reťazce sú ohraničené dvojitými úvodzovkami (") a môžu obsahovať escape sequence. Pre tento prípad existuje špeciálny stav \texttt{STATE\_BACKSLASH\_LITERAL}, do ktorého sa prechádza pri  prečítaní znaku \textbackslash \quad a čaká sa na skratku escape sequence, ako napríklad t, s alebo n. 

\subsection{Štruktúra Token\_t}
Pre jednoduchšiu prácu s tokenmi sme použili štruktúru \texttt{Token\_t}, ktorá obsahovala:

\begin{itemize}
\item \textbf{union Token\_attr}
\item \textbf{struct Token\_type}
\end{itemize}
\textbf{Union Token\_attr} obsahuje možné atribúty tokenu, konkrétne to sú: string, integer, flt a keyword. \\
\textbf{Struct Token\_type} obsahuje typy tokenov, konkrétne to sú: \texttt{EOF}, \texttt{EOL}, identifikátor, kľúčové slovo, relačné a matematické operátory, ľava a pravá zátvorka, čiarka, komentár, int, float a string.


\subsection{Spracovanie reťazcov}
Pre jednoduchšie spracovanie reťazcov sme sa rozhodli implementovať súbor \texttt{dynamic\_string.c}. Jeho súčasťou je aj štruktúra \texttt{string\_t}, ktorá obsahuje samotný ukazateľ na dynamický reťazec, súčastnú veľkosť reťazca a celkovú veľkosť bufferu. Na začiatku je alokovaný reťazec s veľkosťou 10 a pri každom pridaní znaku sa kontroluje, či je ešte v reťazci miesto. Keď sa blížime k zaplneniu reťazca, funkcia \texttt{check\_empty\_bites} zväčší veľkosť buffera o 5, čím zaistí adekvátnu veľkosť pre reťazec. Všetky alokácie pamäte sú kontrolované a ich zlyhanie je adekvátne ošetrené vrátením internej chyby \texttt{ER\_INTERNAL}.

\section{Syntaktická analýza}

\subsection{Sématická analýza}
\subsection{Tabuľka symbolov}
Tabuľku symbolov sme implementovali ako tabuľku s rozptýlenými položkami. Synonymá sú v tabuľke zoradené explicitne, čo zabezpečuje tereticky neobmedzený počet položiek uchovávateľných tabuľkou symbolov. Synonymá sú zreťazené v jednosmerne viazaných zoznamoch. Veľkosť mapovacieho poľa sme vyberali tak, aby bola rovná prvočíslu. Naša tabuľka má veľkosť 6421. Očakávame, že naplnenie tabuľky nepresiahne 75\%. Mapovaciu funkciu sme prevzali z druhej domácej úlohy z IAL, lebo nám pripadala efektívna a ľahko pochopiteľná. Funkcia spočítava ASCII hodnotu jednotlivých znakov kľúča a nakoniec vracia modulo veľkosti tabuľky z daného súčtu. Každá položka tabuľky obsahuje svoj vlastný unikátny kľúč, ktorý sa ukladá v podobe reťazca. Kľúče značia identifikátory funkcii a premenných. Každá položka taktiež obsahuje svoj typ, značiaci či sa jedná o premennú alebo funkciu, boolovskú hodnotu, určujúca či bola položka definovaná, ukazateľ na ďalší prvok v zozname a integer značiaci počet parametrov v prípade, že sa jedná o funkciu. Položky sa ukladajú do 2 idetických tabuliek s rozptýlenými položkami v závislosti od toho, či sa jedná o lokálne alebo globálne premenné. Všetky funkcie sa ukladajú do globálnej tabuľky symbolov. Implementovali sme taktiež niekoľko funkcii zabezpečujúce pohodlnú prácu s tabuľkou. Funkcie zabezpečujú inicializáciu, výpis chybových hlásení, pridávanie prvkov, vyhľadávanie v tabuľke, kontrolu jednotlivých atribútov položiek a čistenie tabuľky.

\section{Generátor inštrukcií}

\section{Práca v tíme}
Náš tím sme si zostavili pomerne skoro. Po rozdelení práce na menšie celky sme začali každý pracovať na časti pridelenej vedúcim tímu. Približne 3 týždne pred pokusným odovzdaním sme začali jednotlivé časti spájať do celku. 

\subsection{Komunikácia}
Už na začiatku sme sa dohodli na pravidelných týždenných stretnutiach, kde sme diskutovali o našej ďaľšej práci na nadchádzajúci týždeň. 

\subsection{Verzovanie}
Pre správu projektu sme používali verzovací systém Git a vzdialený repozitár GitHub. Tento spôsob správy projektu nám umožňoval pracovať na viacerých častiach projektu súčasne. Po otestovaní jednotlivých podčastí sme súbory začali spájať do celku.

\subsection{Hodnotenie}

\section{Prílohy}

\subsection{Deterministický konečný automat}
\subsection{LL-gramatika}
\subsection{Precedenčná tabuľka}
\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
\hline
   & \textbf{+} & \textbf{\--}  & \textbf{*} & \textbf{/} & \textbf{(} & \textbf{)} & \textbf{i}  & \textbf{R} & \textbf{\$} \\ \hline
\textbf{+}  & \textgreater{} & \textless{}    & \textless{}    & \textless{}    & \textless{} & \textgreater{} & \textless{} & \textgreater{} & \textgreater{} \\ \hline
\textbf{\--}  & \textgreater{} & \textgreater{} & \textless{}    & \textless{}    & \textless{} & \textgreater{} & \textless{} & \textgreater{} & \textgreater{} \\ \hline
\textbf{*}  & \textgreater{} & \textgreater{} & \textgreater{} & \textgreater{} & \textless{} & \textgreater{} & \textless{} & \textgreater{} & \textgreater{} \\ \hline
\textbf{/}  & \textless{}    & \textgreater{} & \textgreater{} & \textgreater{} & \textless{} & \textgreater{} & \textless{} & \textgreater{} & \textgreater{} \\ \hline
\textbf{(}  & \textless{}    & \textless{}    & \textless{}    & \textless{}    & \textless{} & =              & \textless{} & \textless{}    &                \\ \hline
\textbf{)}  & \textgreater{} & \textgreater{} & \textgreater{} & \textgreater{} &             & \textgreater{} &             & \textgreater{} & \textgreater{} \\ \hline
\textbf{i}  & \textgreater{} & \textgreater{} & \textgreater{} & \textgreater{} &             & \textgreater{} &             & \textgreater{} & \textgreater{} \\ \hline
\textbf{R}  & \textless{}    & \textless{}    & \textless{}    & \textless{}    & \textless{} & \textgreater{} & \textless{} &                & \textgreater{} \\ \hline
\textbf{\$} & \textless{}    & \textless{}    & \textless{}    & \textless{}    & \textless{} &                & \textless{} & \textless{}    &                \\ \hline
\end{tabular}
\end{table}

\end{document}
